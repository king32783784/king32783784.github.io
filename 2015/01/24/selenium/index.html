<!DOCTYPE html>
<html lang="link">
<head>

        <title>selenium-Sample(二）</title>
        <meta charset="utf-8" />
        <link href="http://king32783784.github.io/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Hi | World Full Atom Feed" />
        <link href="http://king32783784.github.io/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Hi | World Full RSS Feed" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="../../../../theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="../../../../theme/style.css" />
        <link rel="stylesheet" type="text/css" href="../../../../theme/pygment.css" />
        <link rel="stylesheet" type="text/css" href="../../../../theme/SentyZHAO/SentyZHAO.css" />

        <script src="../../../../theme/js/libs/jquery-1.9.1.min.js"></script>
        <script src="../../../../theme/js/libs/modernizr-2.6.2.min.js"></script>
</head>

<body id="index" class="home">
    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1 style='font-family: "SentyZHAO";'><a href="../../../..">Hi | World <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>

              <ul class="columns" style='font-family: "SentyZHAO";'>
                <li><a href="../../../..">主 页</a></li>

                <li><a href="../../../../pages/tech-share.html">归档</a></li>
                <li><a href="../../../../pages/opensource.html">开源项目</a></li>
                <li><a href="../../../../pages/links.html">链接</a></li>
                <li><a href="../../../../pages/Reference material.html">参考资料</a></li>
                <li><a href="../../../../pages/todo list.html">Todo List</a></li>
                <li><a href="../../../../pages/tools.html">工具集</a></li>
                <li class="active"><a href="../../../../pages/aboutme.html">关于我</a></li>

              </ul>
            </div>

<section id="content" class="body">
   <div class="row">
        <div class="columns">
            <header>
              <h2 class="entry-title">
                <a href="../../../../2015/01/24/selenium/" rel="bookmark" title="Permalink to selenium-Sample(二）">selenium-Sample(二）</a></h2>
           Translations: 
<a href="../../../../2015/01/21/selenium/">link</a>
<a href="../../../../2015/01/20/selenium/">link</a>
<a href="../../../../2015/01/14/selenium/">link</a>
<a href="../../../../2015/01/16/selenium/">link</a>
<a href="../../../../2015/01/19/selenium/">link</a>
<a href="../../../../2015/01/23/selenium/">link</a>
<a href="../../../../2015/01/18/selenium/">link</a>
<a href="../../../../2015/01/15/selenium/">link</a>
<a href="../../../../2015/01/17/selenium/">link</a>
<a href="../../../../2015/01/22/selenium/">link</a>
<a href="../../../../2015/01/13/selenium/">link</a>
<a href="../../../../2015/01/25/selenium/">link</a>

            </header>
            <footer class="post-info">
              <abbr class="published" title="2015-01-24T00:00:00+08:00">
                六 24 一月 2015
              </abbr>
              <address class="vcard author">
                By <a class="url fn" href="../../../../author/penglee.html">peng.lee</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              </head><body><h3 id="chang-jian-ying-yong-de-shi-li">常见应用的示例</h3>
<p><strong>Sample List</strong></p>
<p><strong>填写表单示例1-自动设置bugzilla Simple Search</strong></p>
<p><strong>填写表单示例2-自动设置bugzilla Advanced Search</strong></p>
<p><strong>拖放drag和drop示例-待定</strong></p>
<p><strong>窗口和框架之间移动示例-待定</strong></p>
<p><strong>弹出对话框示例-待定</strong></p>
<p><strong>历史记录和位置示例-待定</strong></p>
<p><strong>Cookies示例-待定</strong></p>
<p><strong>元素定位不同方式示例-待定</strong></p>
<div class="highlight"><pre><span></span>ID定位
名称定位
Xpath定位
链接文本定位超链接
Tag Name定位
class name定位
css选择器定位
</pre></div>
<p><strong>等待-不同条件显示等待示例-待定</strong></p>
<div class="highlight"><pre><span></span>title_is
title_contains
presence_of_element_locate
visibility_of_element_located
visibility_of
presence_of_all_elements_located
text_to_be_present_in_element_value
text_to_be_present_in_element
frame_to_be_available_and_switch_to_it
invisibility_of_element_located
elements_to_be_clickable-it is Displayed and Enabled
staleness_of
element_to_be_selected
element_located_to_be_selected
element_selection_state_to_be
element_located_selection_state_to_be
arelt_is_present
</pre></div>
<p><strong>等待-等待示例-隐式等待</strong></p>
<p><strong>页面对象设计模式示例</strong></p>
<p>... ...</p>
<p><img height="280" src="https://d2lm6fxwu08ot6.cloudfront.net/img-thumbs/280h/RGBIHR91YT.jpg" width="420"/></p>
<p><strong>示例3. 填写表单示例1-自动设置bugzilla Simple Search</strong></p>
<p>code:</p>
<table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">Select</span>
<span class="c1"># test网址</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://192.168.32.3/"</span>


<span class="k">class</span> <span class="nc">SampleSearch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span>  <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">doclick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">driver</span>


    <span class="c1"># 导航到samplesearch页面</span>
    <span class="k">def</span> <span class="nf">getSearchpage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">search</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">'query'</span><span class="p">)</span>
        <span class="n">searchdriver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doclick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">search</span><span class="p">)</span>
        <span class="n">simplesearch</span> <span class="o">=</span> <span class="n">searchdriver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">"tab_specific"</span><span class="p">)</span>
        <span class="n">sampledriver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doclick</span><span class="p">(</span><span class="n">searchdriver</span><span class="p">,</span> <span class="n">simplesearch</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sampledriver</span>

    <span class="k">def</span> <span class="nf">setseclect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="n">select</span><span class="o">.</span><span class="n">select_by_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">driver</span>

    <span class="k">def</span> <span class="nf">dosearch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">search</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSearchpage</span><span class="p">()</span>
        <span class="n">statusvalues</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'__all__'</span><span class="p">,)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setseclect</span><span class="p">(</span><span class="n">search</span><span class="p">,</span> <span class="s1">'bug_status'</span><span class="p">,</span> <span class="n">statusvalues</span><span class="p">)</span>
        <span class="n">productvalues</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'iSoft_Desktop_v4.0_for loongson'</span><span class="p">,)</span>
        <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setseclect</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s1">'product'</span><span class="p">,</span> <span class="n">productvalues</span><span class="p">)</span>
        <span class="n">searchbutton</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">"//*[@id='search']"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doclick</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">searchbutton</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">autologin</span> <span class="o">=</span> <span class="n">SampleSearch</span><span class="p">()</span>
    <span class="n">autologin</span><span class="o">.</span><span class="n">dosearch</span><span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<p>分析：
doclick方法实现对选定元素的点击。</p>
<p>getSearchpage 方法获取简单搜索页面</p>
<p>dosearch方法是流程控制</p>
<p>重点讲一下setseclect方法，</p>
<div class="highlight"><pre><span></span>def setseclect(self, driver, name, values):
    select = Select(driver.find_element_by_name(name))) # 通过Select类的调用，获取下拉框
    for value in values: # 进行指定下拉框选项的设定
        select.select_by_value(value)
    return driver
</pre></div>
<p>实现对下拉框的定位和下拉框值的设定。</p>
<p><strong>示例4. 填写表单示例2-自动设置bugzilla Advanced Search</strong></p>
<p>code:</p>
<table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">Select</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>

<span class="c1"># bugzilla address</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://192.168.32.3/"</span>

<span class="k">class</span> <span class="nc">AdvanceSearch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">doclick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">driver</span>

    <span class="k">def</span> <span class="nf">getSearchpage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">search</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">'query'</span><span class="p">)</span>
        <span class="n">searchdriver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doclick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">search</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">searchdriver</span>

    <span class="k">def</span> <span class="nf">setseclect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">selects</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">selects</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">selectlist</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
           <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">selectlist</span><span class="o">.</span><span class="n">select_by_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">driver</span>

    <span class="k">def</span> <span class="nf">dosearch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">product</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'iSoft_Desktop_v4.x_x86-64'</span><span class="p">,</span> <span class="s1">'iSoft_Desktop_v4.0_x86-64'</span><span class="p">]</span>
        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'product'</span><span class="p">:</span> <span class="n">product</span><span class="p">,}</span>
        <span class="n">search</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSearchpage</span><span class="p">()</span>
        <span class="n">setselect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setseclect</span><span class="p">(</span><span class="n">search</span><span class="p">,</span> <span class="n">selects</span><span class="p">)</span>
        <span class="n">searchbutton</span> <span class="o">=</span> <span class="n">setselect</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">'Search'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doclick</span><span class="p">(</span><span class="n">setselect</span><span class="p">,</span> <span class="n">searchbutton</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">autosearch</span> <span class="o">=</span> <span class="n">AdvanceSearch</span><span class="p">()</span>
    <span class="n">autosearch</span><span class="o">.</span><span class="n">dosearch</span><span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<p>分析：
　　大部分和上一个例子代码类似。其中setseclect方法不同</p>
<div class="highlight"><pre><span></span>def setseclect(self, driver, selects):
    for k, v in selects.iteritems():
        selectlist = Select(driver.find_element_by_name(k))
        for value in v:
            selectlist.select_by_value(value)
    return driver
</pre></div>
<p>通过一个字典将选择框的name属性和要选择的项目列表传入。通过遍历，将两个项目复选。</p>
            </div><!-- /.entry-content -->
            <div class="comments">
              <h3>Comments</h3>
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                var disqus_identifier = "2015/01/24/selenium/";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://xiayfblackwhite.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
              </script>
            </div>
        </div><!-- /.twelve.columns -->
 </div><!-- /.row -->
</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">


        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">

                <li><div class="btn primary"><a href="http://github.com/king32783784" target="_blank">Github</a></div></li>






              </ul>
            </div>
          </div>
        </footer>

    </div>


<script type="text/javascript">
    var disqus_shortname = 'xiayfblackwhite';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
  <script src="../../../../theme/js/libs/gumby.min.js"></script>
  <script src="../../../../theme/js/plugins.js"></script>
  <script src="../../../../theme/js/main.js"></script>
  <link rel="stylesheet" type="text/css" href="../../../../theme/emoji/css/basic/emojify.min.css" />
  <script src="../../../../theme/emoji/js/emojify.min.js"></script>
  <script>
    emojify.setConfig({
        img_dir : '../../../../theme/emoji/images/basic'
    });
    emojify.run();
</script>
</body>
</html>